Адаптивный полет с грузом (тестовое задание)
==================================

### Описание дисциплины

[Общая информация](INFO.md)

В рамках дисциплины «Адаптивный полет с грузом» задача Команды разработать и запрограммировать алгоритм управления, позволяющий беспилотному летательному аппарату пролететь по маршруту и сбросить груз наиболее близко к заданной точке за минимальное время. В тестовом задании группа беспилотных аппаратов состоит из одинаковых аппаратов в количестве определяемом заданием. Аппараты являются цифровыми двойниками реальных моделей беспилотных летательных аппаратов мультироторного типа.

В данном задании аппарат оснащен двигателем внутреннего сгорания и использует горючее топливо ввиду чего в течение полета постоянно изменяются его инерциальные характеристики. К аппарату прикреплен груз, который необходимо сбросить во время полета. Сброс груза также ведет к изменению инерциальных характеристик аппарата. Начальная масса аппарата и масса груза выдаются автоматически при запуске Симулятора.

Полигон представляет собой участок горной местности.

Маршрут представляет собой кубический сплайн, заданный его характеристиками. Полет по маршруту начинается при пересечении аппаратом стартовой плоскости и заканчивается при пересечении аппаратом финишной плоскости. При полете по маршруту требуется строгое поддержание траектории. Допустимая зона находится вокруг линии маршрута не дальше некоторого расстояния R от нее. Значение R и характеристики маршрута выдаются автоматически при запуске Симулятора.

Во время полета необходимо сбросить груз в точку назначения. Сброс груза происходит по команде управляющего алгоритма.

### Запуск

Команда для запуска Симулятора выглядит следующим образом

```
./cargo.sh РЕЖИМ_ЛИГИ КОЛ_ВО
```

где РЕЖИМ_ЛИГИ может быть prof для Профессиональной или exp для Экспертной лиги,
КОЛ_ВО - общее количество аппаратов (по умолчанию 1).

Пример запуска в режиме Профессиональной лиги

```
./cargo.sh prof
```

В тестовом задании группа беспилотных аппаратов состоит из одинаковых аппаратов в количестве 1 штуки.

### Задание

Задача Команды разработать алгоритм управления аппаратом, который автоматически:

* выдаст управляющее воздействие на аппарат для перемещения по маршруту;
* определит оптимальную точку сброса груза;
* выдаст команду для сброса груза.

Для Профессиональной Лиги в течение полета аппарата выдается масса израсходованного топлива. Координаты точки назначения выдаются автоматически при запуске Симулятора.

Для Экспертной Лиги в течение полета аппарата выдается мгновенный расход топлива. Координаты точки назначения выдаются при приближении аппарата к ней на расстояние L. Значение L выдается автоматически при запуске Симулятора.

При определении победителя оценивается точность приземления груза и время полета. Побеждает команда, набравшая наибольшее число баллов.

Баллы начисляются или снимаются за следующие действия:

* общее время полета по маршруту;
* среднеквадратичное отклонение траектории аппарата от маршрута;
* среднеквадратичное отклонение точки приземления груза от точки назначения;
* время нахождения аппарата вне допустимой зоны (Критический критерий, при высоких значениях параметра жюри может принять решение о признании результата недействительным).

#### Параметры тестового задания

В коде примера `examples/cargo.py` показано как:
* запросить массу израсходованного топлива
* запросить мгновенный расход топлива
* сбрость груз

Параметры сплайна маршрута: координаты точек (широта, долгота, высота) `tasks/cargo/1/gps_spline.pts`, параметр t точек `tasks/cargo/1/spline_t.txt`

Для получения точной траектории необходимо перейти в декартову систему координат x,y,z и построить кубический сплайн для каждой из координат: x(t), y(t), z(t).
Пример работы с глобальной и декартовой системами координат `examples/convert_gps_local.py`.
Референсный метод построения сплайна (который используется для оценки точности прохождения маршрута)  реализован в библиотеке `scipy.interpolate` языка программирявания `Python`:

```
interp1d(t, x, kind='cubic')
```

Начальная масса аппарата и масса груза: `tasks/cargo/1/mass.txt`

Допустимое расстояние R вокруг линии маршрута (метры): 5

Для Профессиональной лиги координаты точки сброса (широта, долгота, высота): `tasks/cargo/1/gps_droppoint.pts`.

Для Экспертной лиги расстояние до точки назначения L, при которой происходит выдача ее координат (метры): `tasks/cargo/1/range.txt`.

Для Экспертной лиги выдача координат точки назначения в ROS топике:

* `/cargo_drop/point`

Формат строки публикуемой в топик, значения разделены пробелами:

```
ВРЕМЯ_СЕК ШИРОТА ДОЛГОТА ВЫСОТА
```

где ВРЕМЯ_СЕК - время выдачи, в секундах, ШИРОТА ДОЛГОТА ВЫСОТА - глобальные координаты точки назначения.

### Определение отобранных команд

Команды, которые успешно смогут выполнить и загрузить тестовое задние до 23:59 23 ноября, проходят в отбор в финальную часть соревнований.

### Загрузка решения

Решения тестовых заданий необходимо отправлять через форму https://forms.gle/RsRcncF4uQpXgAtVA (требуется учетная запись пользователя Google).
